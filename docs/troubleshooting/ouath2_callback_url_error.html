<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OAuth2 ì½œë°± URL ë§¤ì¹­ ë¯¸ìŠ¤í„°ë¦¬ í•´ê²° ê¸°ë¡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f1f5f9;
        }
        .timeline-item { transition: all 0.3s ease; cursor: pointer; }
        .timeline-item.active { background-color: #007bff; color: white; transform: translateY(-4px); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }
        .timeline-item.active .timeline-phase { color: white; }
        .timeline-item:not(.active):hover { background-color: #e6f3ff; transform: translateY(-2px); }
        .content-fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .code-block {
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-size: 0.875rem;
        }
        .text-error { color: #dc3545; }
        .text-warning { color: #ffc107; }
        .text-success { color: #28a745; }
    </style>
</head>
<body class="text-slate-800">

    <main class="container mx-auto p-4 md:p-8 max-w-5xl">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">ì‚¬ê±´ íŒŒì¼: OAuth2 ì½œë°± í•„í„°ë§ ì‹¤íŒ¨ (Final)</h1>
            <p class="mt-2 text-lg text-slate-600">JWT Filter, ì„¸ì…˜ ë¬¸ì œ í•´ê²° í›„ ìµœì¢… ì½œë°± íŒ¨í„´ ì¶©ëŒ í•´ê²° ê¸°ë¡.</p>
        </header>

        <nav id="timeline-nav" class="flex flex-col md:flex-row justify-center items-center gap-2 md:gap-4 mb-12">
            </nav>

        <div id="content-area">
            </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const caseFiles = [
                {
                    phase: "1ë‹¨ê³„",
                    title: "JWT í•„í„° ìœ„ì¹˜ ì¡°ì •",
                    icon: "â“",
                    content: {
                        symptom: "OAuth2 ì½œë°± ìš”ì²­ì´ Spring Securityì˜ `OAuth2LoginAuthenticationFilter`ì— ë„ë‹¬í•˜ì§€ ëª»í•˜ê³  <span class='text-error'>No mapping</span> ì˜¤ë¥˜ ë°œìƒ.",
                        hypothesis: "JWT Filterê°€ ë„ˆë¬´ ì•ì„œì„œ ì½œë°± URIë¥¼ ê°€ë¡œì±„ê±°ë‚˜, ì˜ëª»ëœ ìœ„ì¹˜ì— ë“±ë¡ë˜ì–´ OAuth2 ì¸ì¦ í”„ë¡œì„¸ìŠ¤ë¥¼ ë°©í•´í–ˆì„ ê²ƒìœ¼ë¡œ ì¶”ì •.",
                        investigation: [
                            "**JWT í•„í„° ìœ„ì¹˜ ì¡°ì •:** `@Component`ì™€ `FilterRegistrationBean`ì„ ì œê±°í•˜ê³ , `SecurityConfig` ë‚´ì—ì„œ <span class='text-success'><strong>.addFilterBefore(jwtFilter, LogoutFilter.class)</strong></span>ë¥¼ ì‚¬ìš©í•˜ì—¬ JWT í•„í„°ë¥¼ ëª…í™•íˆ ì„¤ì •."
                        ],
                        breakthrough: "í•„í„° ìˆœì„œ ìì²´ëŠ” í•´ê²°ë˜ì—ˆìœ¼ë‚˜, ì½œë°± URIê°€ ì—¬ì „íˆ ë§¤ì¹­ë˜ì§€ ì•Šì•„ ë¬¸ì œì˜ ê·¼ì›ì´ ë‹¤ë¥¸ ê³³ì— ìˆìŒì„ ì¸ì§€."
                    }
                },
                {
                    phase: "2ë‹¨ê³„",
                    title: "ì„¸ì…˜ ë° Entry Point ì²˜ë¦¬",
                    icon: "âš”ï¸",
                    content: {
                        symptom: "ì¸ì¦ ì‹¤íŒ¨ ì‹œ `Access Token is missing...` ë©”ì‹œì§€ì™€ í•¨ê»˜ 401 ì˜¤ë¥˜ê°€ ë°œìƒ. ë˜ëŠ” ì„¸ì…˜ ì„¤ì • ë¬¸ì œë¡œ OAuth2 ì¸ì¦ ì „ëµ ìì²´ê°€ íŒŒê´´ëœ ê²ƒìœ¼ë¡œ ì˜ì‹¬.",
                        hypothesis: "OAuth2LoginAuthenticationFilterê°€ ë˜ì§„ ì˜ˆì™¸ë¥¼ JWT í•„í„°ì˜ <span class='text-warning'>CstAuthenticationEntryPoint</span>ê°€ ê°€ë¡œì±„ì„œ ì˜ëª»ëœ ì‘ë‹µì„ ë‚´ë³´ëƒˆê±°ë‚˜, ì„¸ì…˜ ê´€ë ¨ ì„¤ì •ì„ ê±´ë“œë ¤ ë¬¸ì œê°€ ë°œìƒí–ˆì„ ê²ƒìœ¼ë¡œ ì¶”ì •.",
                        investigation: [
                            "**ì„¸ì…˜ ë³µêµ¬:** `@SpringBootApplication`ì˜ `SessionAutoConfiguration` excludeë¥¼ ì œê±°í•˜ê³  `NullAuthenticatedSessionStrategy` ê´€ë ¨ ì½”ë“œë¥¼ ì œê±°í•˜ì—¬ OAuth2ì˜ ì„¸ì…˜ ì „ëµ ë³µêµ¬.",
                            "**Entry Point ìˆ˜ì •:** `CstAuthenticationEntryPoint`ì—ì„œ ì½œë°± URI ìš”ì²­ì´ ë“¤ì–´ì˜¬ ê²½ìš° <span class='text-success'><strong>throw authException</strong></span> ë¡œì§ì„ ì‚¬ìš©í•˜ì—¬ JWT í•¸ë“¤ëŸ¬ì˜ ì˜¤ì‘ë™ì„ ë°©ì§€."
                        ],
                        breakthrough: "JWT í•„í„°, ì„¸ì…˜, Entry Pointì˜ ì˜¤ì‘ë™ì€ ëª¨ë‘ í•´ê²°ë˜ì—ˆì§€ë§Œ, ë¡œê·¸ì— `Did not match request to Ant [pattern='...']` ì˜¤ë¥˜ê°€ ì§€ì†ë¨ì„ í™•ì¸í•˜ê³  **íŒ¨í„´ ë¶ˆì¼ì¹˜ê°€ í•µì‹¬**ì„ì„ í™•ì‹ ."
                    }
                },
                {
                    phase: "3ë‹¨ê³„",
                    title: "ì½œë°± URI íŒ¨í„´ ë¶ˆì¼ì¹˜",
                    icon: "ğŸ”’",
                    content: {
                        symptom: "`redirectionEndpoint`ë¥¼ <span class='text-error'>.baseUri(\"/oauth2/callback/*\")</span>ë¡œ ì„¤ì •í–ˆì„ ë•Œ, ì‹¤ì œ ìš”ì²­ì¸ <span class='text-warning'>/oauth2/callback/login/kakao</span>ì™€ ë§¤ì¹­ë˜ì§€ ì•ŠëŠ” ì˜¤ë¥˜ ë°œìƒ.",
                        hypothesis: "ì»¤ìŠ¤í…€ Ant Path <span class='text-error'>*</span> (ë³„ í•˜ë‚˜)ëŠ” ê²½ë¡œì˜ ê¹Šì´ë¥¼ ëª¨ë‘ ì²˜ë¦¬í•˜ì§€ ëª»í•˜ëŠ” ë¬¸ì œ. ë˜í•œ ì¹´ì¹´ì˜¤ê°€ ë³´ë‚¸ URIì— `/login` ê²½ë¡œê°€ ì¤‘ë³µ í¬í•¨ëœ ê²ƒìœ¼ë¡œ ì¶”ì •.",
                        investigation: [
                            "ë¡œê·¸ì—ì„œ ì‹¤ì œ ìš”ì²­ URIì— <span class='text-error'>/login</span> ê²½ë¡œê°€ ì¤‘ë³µ í¬í•¨ëœ ê²ƒì„ í™•ì¸.",
                            "Ant Pathì˜ <span class='text-error'>*</span> íŒ¨í„´ì€ ê¸°ë³¸ì ìœ¼ë¡œ í•˜ë‚˜ì˜ ê²½ë¡œ ì„¸ê·¸ë¨¼íŠ¸ë§Œ ë§¤ì¹­í•¨ì„ í™•ì¸.",
                            "ì´ë¡œ ì¸í•´ ì»¤ìŠ¤í…€ ì„¤ì •ì´ ë¬´íš¨í™”ë˜ê³  Springì˜ ê¸°ë³¸ íŒ¨í„´ìœ¼ë¡œ ëŒì•„ê°€ë ¤ë‹¤ ì¶©ëŒ ë°œìƒ."
                        ],
                        breakthrough: "ë¬¸ì œì˜ ì›ì¸ì´ **URL íŒ¨í„´ì˜ ê¹Šì´ ë§¤ì¹­**ì— ìˆìŒì„ ìµœì¢… í™•ì¸í•˜ê³ , ê²½ë¡œ ê¹Šì´ ë§¤ì¹­ì„ ìœ„í•œ ì˜¬ë°”ë¥¸ Ant Path êµ¬ë¬¸ì„ ì ìš©í•˜ê¸°ë¡œ ê²°ì •."
                    }
                },
                {
                    phase: "4ë‹¨ê³„",
                    title: "ê·¼ë³¸ì ì¸ í•´ê²°",
                    icon: "âœ…",
                    content: {
                        symptom: "ëª¨ë“  JWT/ì„¸ì…˜/Entry Point ë¬¸ì œë¥¼ í•´ê²°í–ˆìŒì—ë„ ì½œë°± URI í•„í„°ë§ë§Œ ì‹¤íŒ¨í•˜ëŠ” ìµœì¢… ì¦ìƒ.",
                        hypothesis: "DB ì¸ì½”ë”© ë¬¸ì œì™€ ë§ˆì°¬ê°€ì§€ë¡œ, ì´ë²ˆì—ë„ Spring Security ì„¤ì •ì˜ **í•µì‹¬ êµ¬ë¬¸** ì˜¤ë¥˜ê°€ ë¬¸ì œì¼ ê²ƒìœ¼ë¡œ ì¶”ì •.",
                        investigation: [
                            "Ant Pathì—ì„œ ëª¨ë“  í•˜ìœ„ ê²½ë¡œë¥¼ í¬í•¨í•˜ëŠ” ë¬¸ë²•ì„ ì¬í™•ì¸."
                        ],
                        breakthrough: "ë¬¸ì œëŠ” Ant Path ì„¤ì •ì— <span class='text-error'>*</span> ëŒ€ì‹  <span class='text-success'><strong>**</strong></span>ë¥¼ ì‚¬ìš©í•´ì•¼ ëª¨ë“  ê²½ë¡œ ê¹Šì´(`login/kakao` ë“±)ë¥¼ í¬í•¨í•˜ì—¬ ë§¤ì¹­í•  ìˆ˜ ìˆì—ˆê¸° ë•Œë¬¸ì„ì„ ìµœì¢… í™•ì¸. `SecurityConfig`ì˜ `redirectionEndpoint` ì„¤ì •ì„ <span class='text-success'><strong>.baseUri(\"/oauth2/callback/**\")</strong></span>ë¡œ ìˆ˜ì •í•˜ì—¬ Gmail ì—°ë™ ë¡œì§ì—ë„ ì‚¬ì´ë“œ ì´í™íŠ¸ ì—†ì´ ë¬¸ì œ ì™„ì „íˆ í•´ê²°. "
                    }
                }
            ];

            const timelineNav = document.getElementById('timeline-nav');
            const contentArea = document.getElementById('content-area');
            let currentPhaseIndex = 0;

            function render() {
                // íƒ€ì„ë¼ì¸ ë Œë”ë§
                timelineNav.innerHTML = '';
                caseFiles.forEach((file, index) => {
                    const item = document.createElement('div');
                    item.className = `timeline-item flex-1 p-3 md:p-4 rounded-lg shadow-md bg-white border border-slate-200 text-center ${index === currentPhaseIndex ? 'active' : ''}`;
                    item.dataset.index = index;
                    item.innerHTML = `
                        <div class="text-3xl mb-1">${file.icon}</div>
                        <div class="font-bold text-sm md:text-base">${file.title}</div>
                        <div class="timeline-phase text-xs text-slate-500">${file.phase}</div>
                    `;
                    timelineNav.appendChild(item);
                });

                // ì½˜í…ì¸  ë Œë”ë§
                const file = caseFiles[currentPhaseIndex];
                contentArea.innerHTML = '';
                const contentDiv = document.createElement('div');
                contentDiv.className = 'content-fade-in bg-white p-6 md:p-8 rounded-lg shadow-lg border border-slate-200';
                
                let investigationItems = file.content.investigation
                    .map(item => `<li class="flex items-start"><span class="mr-2 text-blue-500">-</span><span>${item}</span></li>`)
                    .join('');

                contentDiv.innerHTML = `
                    <h2 class="text-2xl font-bold mb-4 text-slate-900">${file.icon} ${file.title}</h2>
                    <div class="space-y-6">
                        <div>
                            <h3 class="font-semibold text-lg text-red-600 mb-2">ì¦ìƒ</h3>
                            <p class="text-slate-700">${file.content.symptom}</p>
                        </div>
                        <div>
                            <h3 class="font-semibold text-lg text-yellow-600 mb-2">ì´ˆê¸° ê°€ì„¤ / ì‹œë„</h3>
                            <p class="text-slate-700">${file.content.hypothesis}</p>
                        </div>
                        <div>
                            <h3 class="font-semibold text-lg text-blue-600 mb-2">ìˆ˜ì‚¬ ë° ë‹¨ì„œ (ì‹œí–‰ì°©ì˜¤ í¬í•¨)</h3>
                            <ul class="space-y-2 text-slate-700">${investigationItems}</ul>
                        </div>
                        <div>
                            <h3 class="font-semibold text-lg text-green-600 mb-2">ê²°ì •ì  ëŒíŒŒêµ¬ / ê²°ë¡ </h3>
                            <p class="text-slate-700 font-medium">${file.content.breakthrough}</p>
                        </div>
                    </div>
                `;
                contentArea.appendChild(contentDiv);
            }
            
            timelineNav.addEventListener('click', (e) => {
                const target = e.target.closest('.timeline-item');
                if (target && target.dataset.index) {
                    currentPhaseIndex = parseInt(target.dataset.index, 10);
                    render();
                }
            });

            // ì´ˆê¸° ë Œë”ë§
            render();
        });
    </script>

</body>
</html>